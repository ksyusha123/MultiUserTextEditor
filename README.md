# Многопользовательский текстовый редактор  

Авторы: Астахова Ксения, Жданов Илья

## Описание проекта  
Многопользовательский текстовый редактор с GUI, с использованием автоматического разрешения конфликтов с помощью операциональных преобразований.  

## Состав  
gui.py - GUI (главный файл)
client.py - клиентская логика
server.py - сервер
operations.py - классы доступных операций
operations_converter.py - преобразование операций


## Запуск  
Для работы необходимо запустить сервер командой python server.py и GUI командой python gui.py

## Подробности реализации  
Каждый клиент хранит:  
- свой guid  
- очередь операций, ожидающих отправки  
- id файла, с которым он работает  

Сервер хранит:  
- лог ревизий (примененный операции и клиентов, которые их инициировали)  
- очередь с запросами, ожидающими подтверждения  
- для каждого файла:
    - состояние   
    - пользователей, редактирующих этот файл  
    - предыдущую операцию  

Клиент и сервер отправляют друг другу json-файлы, соответствуюшие протоколу  
Клиент отправляет данные в виде:
```
{
    "server_id": server_guid,
    "user_id": user_guid,
    "operation": 
    {
        "name": operation.name,
        "text": operation.text (не указывается для DeleteOperation),
        "index": operation.index
    },
    "revision": revision
}
```
Сервер отправляет:  
подтверждение пользователю, который инициировал операцию
```
{
    "operation": "ack",
    "revision": revision,
    "file_id": file_id
}
```

саму операцию всем остальным пользователям, редактирующим этот документ
```
{
    "operation": applied_operation.to_dict(),
    "revision": revision
}
```
